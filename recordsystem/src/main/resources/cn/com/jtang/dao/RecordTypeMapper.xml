<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.com.jtang.dao.RecordTypeMapper">
    <resultMap id="BaseResultMap" type="cn.com.jtang.po.RecordType">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        <id column="id" jdbcType="VARCHAR" property="id"/>
        <result column="fondsid" jdbcType="VARCHAR" property="fondsid"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="volumetable" jdbcType="VARCHAR" property="volumetable"/>
        <result column="recordtable" jdbcType="VARCHAR" property="recordtable"/>
        <result column="temtableindex" jdbcType="INTEGER" property="temtableindex"/>
        <result column="volumenoindex" jdbcType="INTEGER" property="volumenoindex"/>
        <result column="typeNo" jdbcType="VARCHAR" property="typeno"/>
        <result column="createtime" jdbcType="TIMESTAMP" property="createtime"/>
    </resultMap>
    <resultMap id="AddFondsMap" type="cn.com.jtang.po.custom.FondsRecordType" extends="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        <result column="fondsname" jdbcType="VARCHAR" property="fonds"/>
    </resultMap>
    <sql id="Example_Where_Clause">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        <where>
            <foreach collection="oredCriteria" item="criteria" separator="or">
                <if test="criteria.valid">
                    <trim prefix="(" prefixOverrides="and" suffix=")">
                        <foreach collection="criteria.criteria" item="criterion">
                            <choose>
                                <when test="criterion.noValue">
                                    and ${criterion.condition}
                                </when>
                                <when test="criterion.singleValue">
                                    and ${criterion.condition} #{criterion.value}
                                </when>
                                <when test="criterion.betweenValue">
                                    and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                                </when>
                                <when test="criterion.listValue">
                                    and ${criterion.condition}
                                    <foreach close=")" collection="criterion.value" item="listItem" open="("
                                             separator=",">
                                        #{listItem}
                                    </foreach>
                                </when>
                            </choose>
                        </foreach>
                    </trim>
                </if>
            </foreach>
        </where>
    </sql>
    <sql id="Update_By_Example_Where_Clause">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        <where>
            <foreach collection="example.oredCriteria" item="criteria" separator="or">
                <if test="criteria.valid">
                    <trim prefix="(" prefixOverrides="and" suffix=")">
                        <foreach collection="criteria.criteria" item="criterion">
                            <choose>
                                <when test="criterion.noValue">
                                    and ${criterion.condition}
                                </when>
                                <when test="criterion.singleValue">
                                    and ${criterion.condition} #{criterion.value}
                                </when>
                                <when test="criterion.betweenValue">
                                    and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                                </when>
                                <when test="criterion.listValue">
                                    and ${criterion.condition}
                                    <foreach close=")" collection="criterion.value" item="listItem" open="("
                                             separator=",">
                                        #{listItem}
                                    </foreach>
                                </when>
                            </choose>
                        </foreach>
                    </trim>
                </if>
            </foreach>
        </where>
    </sql>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        id, fondsid, name, volumetable, recordtable, temtableindex, volumenoindex,typeNo, createtime
    </sql>
    <sql id="AddFonds_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        recordtype.id as id, fondsid,recordtype.name as name, fonds.name as fondsname, volumetable, recordtable,
        temtableindex, typeNo, recordtype.createtime as createtime
    </sql>
    <select id="selectByExample" parameterType="cn.com.jtang.po.RecordTypeExample" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        select
        <if test="distinct">
            distinct
        </if>
        <include refid="Base_Column_List"/>
        from recordtype
        <if test="_parameter != null">
            <include refid="Example_Where_Clause"/>
        </if>
        <if test="orderByClause != null">
            order by ${orderByClause}
        </if>
        <if test="start &gt; -1">
            limit #{start} , #{limit}
        </if>
    </select>
    <select id="selectIds" parameterType="map" resultType="String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        select id FROM recordtype
    </select>
    <select id="selectAccessRecordTree" parameterType="map" resultMap="BaseResultMap3">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        select fonds.id as id,fonds.name,fonds.fondsNo as fondsno,recordtype.id as rtid,recordtype.name as
        rtname,recordtype.typeNo as typeno from accesscontrol join recordtype on accesscontrol.recordtypeid =
        recordtype.id join fonds on fonds.id = recordtype.fondsid where userid = #{userid,jdbcType=VARCHAR} and accesspermission != ''
    </select>
    <select id="getDocumentPaths" parameterType="java.lang.String" resultMap="BaseResultMap">
    
    (select ducument.path from ${tablePrefix}_document as ducument) union (select pducument.path from ${tablePrefix}_piecedocument as pducument)
  </select>
    <select id="selectAddFondsByExample" parameterType="cn.com.jtang.po.RecordTypeExample" resultMap="AddFondsMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        select
        <if test="distinct">
            distinct
        </if>
        <include refid="AddFonds_Column_List"/>
        from recordtype join fonds on recordtype.fondsid = fonds.id
        <if test="_parameter != null">
            <include refid="Example_Where_Clause"/>
        </if>
        <if test="orderByClause != null">
            order by ${orderByClause}
        </if>
        <if test="start &gt; -1">
            limit #{start} , #{limit}
        </if>
    </select>
    <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        select
        <include refid="Base_Column_List"/>
        from recordtype
        where id = #{id,jdbcType=VARCHAR}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        delete from recordtype
        where id = #{id,jdbcType=VARCHAR};
        delete from archivesaudit where recordtypeid = #{id,jdbcType=VARCHAR};
    </delete>
    <delete id="deleteByExample" parameterType="cn.com.jtang.po.RecordTypeExample">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        delete from recordtype
        <if test="_parameter != null">
            <include refid="Example_Where_Clause"/>
        </if>
    </delete>
    <insert id="insert" parameterType="cn.com.jtang.po.RecordType">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        insert into recordtype (id, fondsid, name,
        volumetable, recordtable, temtableindex,
        typeNo, createtime)
        values (#{id,jdbcType=VARCHAR}, #{fondsid,jdbcType=VARCHAR}, #{name,jdbcType=VARCHAR},
        #{volumetable,jdbcType=VARCHAR}, #{recordtable,jdbcType=VARCHAR}, #{temtableindex,jdbcType=INTEGER},
        #{typeno,jdbcType=VARCHAR}, #{createtime,jdbcType=TIMESTAMP})
    </insert>
    <insert id="insertSelective" parameterType="cn.com.jtang.po.RecordType">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        insert into recordtype
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="fondsid != null">
                fondsid,
            </if>
            <if test="name != null">
                name,
            </if>
            <if test="volumetable != null">
                volumetable,
            </if>
            <if test="recordtable != null">
                recordtable,
            </if>
            <if test="temtableindex != null">
                temtableindex,
            </if>
            <if test="typeno != null">
                typeNo,
            </if>
            <if test="createtime != null">
                createtime,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=VARCHAR},
            </if>
            <if test="fondsid != null">
                #{fondsid,jdbcType=VARCHAR},
            </if>
            <if test="name != null">
                #{name,jdbcType=VARCHAR},
            </if>
            <if test="volumetable != null">
                #{volumetable,jdbcType=VARCHAR},
            </if>
            <if test="recordtable != null">
                #{recordtable,jdbcType=VARCHAR},
            </if>
            <if test="temtableindex != null">
                #{temtableindex,jdbcType=INTEGER},
            </if>
            <if test="typeno != null">
                #{typeno,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <select id="countByExample" parameterType="cn.com.jtang.po.RecordTypeExample" resultType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        select count(*) from recordtype
        <if test="_parameter != null">
            <include refid="Example_Where_Clause"/>
        </if>
    </select>
    <update id="updateByExampleSelective" parameterType="map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        update recordtype
        <set>
            <if test="record.id != null">
                id = #{record.id,jdbcType=VARCHAR},
            </if>
            <if test="record.fondsid != null">
                fondsid = #{record.fondsid,jdbcType=VARCHAR},
            </if>
            <if test="record.name != null">
                name = #{record.name,jdbcType=VARCHAR},
            </if>
            <if test="record.volumetable != null">
                volumetable = #{record.volumetable,jdbcType=VARCHAR},
            </if>
            <if test="record.recordtable != null">
                recordtable = #{record.recordtable,jdbcType=VARCHAR},
            </if>
            <if test="record.temtableindex != null">
                temtableindex = #{record.temtableindex,jdbcType=INTEGER},
            </if>
            <if test="record.typeno != null">
                typeNo = #{record.typeno,jdbcType=VARCHAR},
            </if>
            <if test="record.createtime != null">
                createtime = #{record.createtime,jdbcType=TIMESTAMP},
            </if>
        </set>
        <if test="_parameter != null">
            <include refid="Update_By_Example_Where_Clause"/>
        </if>
    </update>
    <update id="updateByExample" parameterType="map">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        update recordtype
        set id = #{record.id,jdbcType=VARCHAR},
        fondsid = #{record.fondsid,jdbcType=VARCHAR},
        name = #{record.name,jdbcType=VARCHAR},
        volumetable = #{record.volumetable,jdbcType=VARCHAR},
        recordtable = #{record.recordtable,jdbcType=VARCHAR},
        temtableindex = #{record.temtableindex,jdbcType=INTEGER},
        typeNo = #{record.typeno,jdbcType=VARCHAR},
        createtime = #{record.createtime,jdbcType=TIMESTAMP}
        <if test="_parameter != null">
            <include refid="Update_By_Example_Where_Clause"/>
        </if>
    </update>
    <update id="indexAddOne" parameterType="String">
          update recordtype set volumenoindex = volumenoindex +1 where id = #{recordtype,jdbcType=VARCHAR}
    </update>
    <update id="indexMinusOne" parameterType="String">
          update recordtype set volumenoindex = volumenoindex -1 where volumenoindex>0 and id = #{recordtype,jdbcType=VARCHAR};
    </update>
    <update id="updateByPrimaryKeySelective" parameterType="cn.com.jtang.po.RecordType">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        update recordtype
        <set>
            <if test="fondsid != null">
                fondsid = #{fondsid,jdbcType=VARCHAR},
            </if>
            <if test="name != null">
                name = #{name,jdbcType=VARCHAR},
            </if>
            <if test="volumetable != null">
                volumetable = #{volumetable,jdbcType=VARCHAR},
            </if>
            <if test="recordtable != null">
                recordtable = #{recordtable,jdbcType=VARCHAR},
            </if>
            <if test="temtableindex != null">
                temtableindex = #{temtableindex,jdbcType=INTEGER},
            </if>
            <if test="typeno != null">
                typeNo = #{typeno,jdbcType=VARCHAR},
            </if>
            <if test="createtime != null">
                createtime = #{createtime,jdbcType=TIMESTAMP},
            </if>
        </set>
        where id = #{id,jdbcType=VARCHAR}
    </update>
    <update id="updateByPrimaryKey" parameterType="cn.com.jtang.po.RecordType">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 22 10:57:40 CST 2016.
        -->
        update recordtype
        set fondsid = #{fondsid,jdbcType=VARCHAR},
        name = #{name,jdbcType=VARCHAR},
        volumetable = #{volumetable,jdbcType=VARCHAR},
        recordtable = #{recordtable,jdbcType=VARCHAR},
        temtableindex = #{temtableindex,jdbcType=INTEGER},
        typeNo = #{typeno,jdbcType=VARCHAR},
        createtime = #{createtime,jdbcType=TIMESTAMP}
        where id = #{id,jdbcType=VARCHAR}
    </update>

    <update id="createRecordTable" parameterType="cn.com.jtang.po.CreateTable">
        create table ${recordTableName} (
        id varchar(32) primary key,
        <foreach collection="record_fields_value" item="field">
            ${field.fieldName} varchar
            <if test="field.fieldLength!=null">
                <if test="field.fieldLength!=0">
                    <trim prefix="(" suffix=")">
                        ${field.fieldLength}
                    </trim>
                </if>
            </if>
            ,
        </foreach>
        checkstatus varchar(4),volumeid varchar(32),operator varchar(32),tableid varchar(32),
        createtime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
        updatetime timestamp NULL DEFAULT NULL
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ;
    </update>

    <update id="createVolumeTable" parameterType="cn.com.jtang.po.CreateTable">
        create table ${volumeTableName} (
        id varchar(32) primary key,
        <foreach collection="volume_fields_value" item="field">
            <if test="field.fieldName!='sequencNo'">
                ${field.fieldName} varchar
                <if test="field.fieldLength!=null">
                    <if test="field.fieldLength!=0">
                        <trim prefix="(" suffix=")">
                            ${field.fieldLength}
                        </trim>
                    </if>
                </if>
                ,
            </if>
        </foreach>
        checkstatus varchar(4),operator varchar(32),
        createtime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
        updatetime timestamp NULL DEFAULT NULL
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ;
    </update>

    <update id="createPieceTable" parameterType="cn.com.jtang.po.CreateTable">
        create table ${pieceTableName} (
        id varchar(32) primary key,
        <foreach collection="piece_fields_value" item="field">
            ${field.fieldName} varchar
            <if test="field.fieldLength!=null">
                <if test="field.fieldLength!=0">
                    <trim prefix="(" suffix=")">
                        ${field.fieldLength}
                    </trim>
                </if>
            </if>
            ,
        </foreach>
        checkstatus varchar(4),volumeid varchar(32),operator varchar(32),tableid varchar(32),
        createtime timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
        updatetime timestamp NULL DEFAULT NULL
        ) ENGINE=InnoDB DEFAULT CHARSET=utf8 ;
    </update>
    <update id="createDocumentTable" parameterType="cn.com.jtang.po.CreateTable">
		create table ${documentTableName} (
		id varchar(32) primary key,path varchar(128),recordid varchar(32),uploadtime timestamp ON UPDATE CURRENT_TIMESTAMP,
		constraint ${recordTableName}id_recordid foreign key (recordid) references ${recordTableName} (id)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8 ;
  </update>
    <update id="createPieceDocumentTable" parameterType="cn.com.jtang.po.CreateTable">
		create table ${pieceDocumentTableName} (
		id varchar(32) primary key,path varchar(128),recordid varchar(32),uploadtime timestamp ON UPDATE CURRENT_TIMESTAMP,
		constraint ${pieceTableName}id_pieceid foreign key (recordid) references ${pieceTableName} (id)
		) ENGINE=InnoDB DEFAULT CHARSET=utf8 ;
  </update>

    <insert id="insertFields" parameterType="cn.com.jtang.po.TableField">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jun 30 14:06:51 CST 2016.
        -->
        insert into tablefield
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="fieldid != null">
                fieldid,
            </if>
            <if test="length != null">
                length,
            </if>
            <if test="name != null">
                name,
            </if>
            <if test="recordTypeid != null">
                recordTypeid,
            </if>
            <if test="fieldNo != null">
                fieldNo,
            </if>
            <if test="fieldName != null">
                fieldName,
            </if>
            <if test="type != null">
                type,
            </if>
            <if test="tabletype != null">
                tabletype,
            </if>
            <if test="valueorindex != null">
                valueorindex,
            </if>
            <if test="idorvalue != null">
                idorvalue,
            </if>
            <if test="zeronum != null">
                zeronum,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="fieldid != null">
                #{fieldid,jdbcType=VARCHAR},
            </if>
            <if test="length != null">
                #{length,jdbcType=VARCHAR},
            </if>
            <if test="name != null">
                #{name,jdbcType=VARCHAR},
            </if>
            <if test="recordTypeid != null">
                #{recordTypeid,jdbcType=VARCHAR},
            </if>
            <if test="fieldNo != null">
                #{fieldNo,jdbcType=VARCHAR},
            </if>
            <if test="fieldName != null">
                #{fieldName,jdbcType=VARCHAR},
            </if>
            <if test="type != null">
                #{type,jdbcType=VARCHAR},
            </if>
            <if test="tabletype != null">
                #{tabletype,jdbcType=VARCHAR},
            </if>
            <if test="valueorindex != null">
                #{valueorindex,jdbcType=VARCHAR},
            </if>
            <if test="idorvalue != null">
                #{idorvalue,jdbcType=VARCHAR},
            </if>
            <if test="zeronum != null">
                #{zeronum,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <resultMap id="BaseResultMap2" type="cn.com.jtang.po.TableField">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Thu Jun 30 14:06:51 CST 2016.
        -->
        <id column="fieldid" jdbcType="VARCHAR" property="fieldid"/>
        <result column="name" jdbcType="VARCHAR" property="name"/>
        <result column="recordTypeid" jdbcType="VARCHAR" property="recordTypeid"/>
        <result column="fieldNo" jdbcType="VARCHAR" property="fieldNo"/>
        <result column="fieldName" jdbcType="VARCHAR" property="fieldName"/>
        <result column="length" jdbcType="VARCHAR" property="length"/>
        <result column="type" jdbcType="VARCHAR" property="type"/>
        <result column="tabletype" jdbcType="VARCHAR" property="tabletype"/>
        <result column="valueorindex" jdbcType="VARCHAR" property="valueorindex"/>
        <result column="idorvalue" jdbcType="VARCHAR" property="idorvalue"/>
        <result column="zeronum" jdbcType="VARCHAR" property="zeronum"/>
    </resultMap>

    <select id="getCustomValueFields" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select 
    	    fieldid,name,recordTypeid,fieldNo,fieldName,length ,type,tabletype,valueorindex,idorvalue,zeronum
    	from tablefield 
    	    where recordTypeid = #{recordtypeid} and type = 1 and tabletype = #{type}and valueorindex = "0"
  </select>
    <select id="getTitle" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select 
    	    fieldid,name,recordTypeid,fieldNo,fieldName,length ,type,tabletype,valueorindex,idorvalue,zeronum
    	from tablefield 
    	    where recordTypeid = #{recordtypeid} and tabletype = #{type} and fieldName = 'subject'
  </select>
    <select id="getCustomIndexFields" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select
    	    fieldid,name,recordTypeid,fieldNo,fieldName,length ,type,tabletype,idorvalue,zeronum
    	from tablefield
    	    where recordTypeid = #{recordtypeid} and type = 1 and tabletype = #{type}and valueorindex = "1"
  </select>
    <select id="getRecordIdOrValueFields" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select fieldid,name,recordTypeid,fieldNo,fieldName,length ,type,tabletype,idorvalue,zeronum
    	from tablefield where recordTypeid = #{recordtypeid}  and tabletype = #{type}and (valueorindex = '0' or valueorindex = '1' or fieldname IN ('year','department','deadline'))
  </select>
    <select id="getBasicFields" parameterType="java.lang.String" resultType="String">
    	select fieldName from tablefield where recordTypeid = #{recordtypeid} and ISNULL(type) and tabletype = #{type}
  </select>
    <select id="getFields" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select
    	    fieldid,name,recordTypeid,fieldNo,fieldName,length ,type,tabletype,idorvalue,zeronum
    	from tablefield
    	    where recordTypeid = #{recordtypeid} and type = 1 and tabletype = #{type}
  </select>

    <select id="getAllFields" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select 
    	    fieldid,name,recordTypeid,fieldNo,fieldName,length ,type,tabletype,valueorindex,idorvalue,zeronum
    	from tablefield 
    	    where recordTypeid = #{recordtypeid} and tabletype = #{type}
  </select>

    <select id="getAllFieldsImf" parameterType="java.lang.String" resultMap="BaseResultMap2">
    	select 
    	    tf.fieldid,tf.name,tf.recordTypeid,tf.fieldNo,tf.fieldName,tf.length ,tf.type,tf.tabletype,tf.valueorindex,f.fondsNo,rt.typeNo,rt.id
    	from tablefield as tf
    	left join recordtype as rt on rt.id = tf.recordtypeid
    	left join fonds as f on f.id = rt.fondsid
    	    where tf.recordtypeid = #{recordtypeid} and tf.tabletype = #{type}
  </select>
    <select id="selectTableByRecordTypeId" parameterType="java.lang.String" resultType="cn.com.jtang.po.custom.Table">
    	select 
    	    tableid,name
    	from template 
    	    where recordTypeid = #{recordtypeid}
  </select>

    <resultMap id="BaseResultMap3" type="cn.com.jtang.po.custom.FondsTree">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 01 13:26:35 CST 2016.
        -->
        <!--<association property="fonds" column="id" javaType="cn.com.jtang.po.FondsView">
            <id column="id" jdbcType="VARCHAR" property="id"/>
            <result column="name" jdbcType="VARCHAR" property="name"/>
            <result column="fondsNo" jdbcType="VARCHAR" property="fondsno"/>
        </association>-->
        <id column="id" jdbcType="VARCHAR" property="fonds.id"/>
        <result column="name" jdbcType="VARCHAR" property="fonds.name"/>
        <result column="fondsno" jdbcType="VARCHAR" property="fonds.fondsno"/>
        <collection column="id" property="recordTypes" ofType="cn.com.jtang.po.RecordType">
            <id column="rtid" jdbcType="VARCHAR" property="id"/>
            <result column="rtname" jdbcType="VARCHAR" property="name"/>
            <result column="typeno" jdbcType="VARCHAR" property="typeno"/>
        </collection>
    </resultMap>
    <select id="getAllBasicField" resultMap="BaseResultMap3">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri Jul 01 13:26:35 CST 2016.
        -->
        select
        <if test="distinct">
            distinct
        </if>
        fonds.id as id,fonds.name,fonds.fondsNo as fondsno,recordtype.id as rtid,recordtype.name as
        rtname,recordtype.typeNo as typeno
        from fonds left join recordtype on fonds.id = recordtype.fondsid
    </select>

    <delete id="deleteTable" parameterType="java.lang.String">
        SET FOREIGN_KEY_CHECKS=0;

        <foreach collection="tablenames" item="tablename">
            drop table if exists ${tablename};
        </foreach>
    </delete>
    <delete id="deleteTableFieldByRecordTypeId" parameterType="java.lang.String">
  	delete from tablefield where recordtypeid = #{recordtypeid }
  </delete>
    <select id="getTableNames" resultType="String">
        
        select tableid as tablename from template where recordtypeid = #{recordtypeid} union select piecetableid as tablename from template where recordtypeid = #{recordtypeid}
    </select>
</mapper>